export const preload = async ({ id, origin }) => {
  const { views, date } = await fetch(`${origin}/api/views/${id}`).then(
    response => response.json()
  );
  return {
    layout: {
      views,
      date,
      title: 'state-ref 라이브러리 인터뷰',
      description:
        'state-ref는 옵저버 패턴에 기반한 상태 관리 시스템입니다. 다른 UI라이브러리들과 쉽게 함께 쓰일수 있는 컨셉을 잡고 만들어졌습니다.',
      openGraph: {
        title: 'state-ref 라이브러리 인터뷰',
        description:
          'state-ref는 옵저버 패턴에 기반한 상태 관리 시스템입니다. 다른 UI라이브러리들과 쉽게 함께 쓰일수 있는 컨셉을 잡고 만들어졌습니다.',
        images: [{ url: '/assets/posts/state-ref-library-interview.png' }],
      },
    },
  };
};

> 원문: [https://survivejs.com/blog/state-ref-interview/](https://survivejs.com/blog/state-ref-interview/)

<img src="/assets/posts/state-ref-library-interview.png" />

## 1. 본인에 대해 간단히 소개해 주시겠습니까?

안녕하세요, 저는 Kim Jinwoo라는 한국에 살고있는 평범한 웹개발자입니다. 프로그래밍을 직업으로 하고 있습니다.

사실 회사 밖에서도 코딩을 게임처럼 즐기는 편입니다. 부끄럽지만 사실은 웹개발에 대해서 뛰어난 전문성을 갖고 있다고 생각하며 개발자로서의 자존감이 매우 높은 편입니다 :)

잘 하고 있는지는 모르겠지만, 어쨌거나 프로그래머로 태어났기 때문에 어떻게든 좋은 아이디어나 코드로 세상에 조금이라도 기여하고 싶은 꿈이 있습니다.

앞으로 얼마나 남았는지는 잘 모르겠지만 프로그래머로 살 수 있는 동안은 더 멋진걸 만들어 보고 싶습니다. 쉽지 않네요.

## 2. state-ref를 전혀 들어본 적이 없는 사람에게 state-ref를 어떻게 설명하시겠습니까?


`state-ref`는 [옵저버 패턴](https://en.wikipedia.org/wiki/Observer_pattern)에 기반한 상태 관리 시스템입니다. 다른 UI라이브러리들과 쉽게 함께 쓰일수 있는 컨셉을 잡고 만들어졌습니다.

`state-ref`는 옵저버 패턴을 잘 구현한 구현체입니다. 개발자라면 다들 이 패턴을 저보다 잘 아시겠지만 이 패턴을 이해하면 프로그램이 어떻게 상태를 관리하고 상태변화에 의존성이 있는 코드가 어떻게 자동으로 새로운 상태를 반영하는지 명확하게 알 수 있습니다. `state-ref`는 이 패턴을 다양한 상황에서 쉽게 접근하여 사용하도록 간편화하여 api로 만든 것입니다.

`state-ref`는 여러가지 많은 종류의 UI라이브러리들(예를들면 React, Preact, Vue, Svelte, Solidjs )과 쉽게 같이 사용할 것을 염두에 두고 만들어지긴 했지만, 어떤 라이브러리들에게도 의존성을 갖지 않고 독립적으로도 사용할수 있습니다.


## 3. state-ref는 어떻게 작동하나요?

`StateRef`는 값 변경의 판단을 데이터 불변성에 초점을 맞춰 만들었습니다.

사용자가 스토어의 값을 직접 꺼내어 읽을때를 추적하여 해당 참조를 의존성 콜백에 추가합니다.

참조의 위치를 기억하거나 찾는 패턴은 함수형 프로그래밍의 랜즈패턴을 이용하여 정확한 참조의 위치를 찾을수 있도록 하였습니다.

사용자가 값을 변경할 때는 제가 설계해 놓은 인터페이스에 따라 값의 변경을 시도하게 되고 stateRef 내부에서는 메모리 관리 기법인 `copyOnWrite`에 의해 값이 안전하게 변경됩니다.

`copyOnWrite` 기법의 특성에 의해 stateRef는 변경된 값에 영향을 미치는 참조를 정확하게 판단하여 의존성이 있는 콜백을 찾아 실행 합니다.

## 4. state-ref는 다른 솔루션과 어떻게 다릅니까?

다른 솔루션에 비해 값에 접근하고 변경하는 방식이 훨씬 쉽고 직관적입니다. 예를 들면 다른 솔루션들은 중첩된 하위노드를 가지는 객체나 배열의 경우 `copyOnWrite`를 사용자가 알아서 직접 처리해줘야 하는 불편함이 있지만, stateRef는 자체적으로 알아서 `copyOnWrite`를 해주기 때문에 사용성이 간편합니다.

또한 다른 솔루션들은 특정 UI라이브러리들을 위해 만들어졌기 때문에 특정 UI라이브러리들과 생명주기를 함께합니다. 하지만 “state-ref”는 다른 UI라이브러리들에 어떠한 의존성도 없기 때문에 변경이나 확장에 더 유연합니다.

## 5. state-ref를 개발한 이유는 무엇입니까?

대부분의 js 상태관리라이브러리가 특정 UI라이브러리와 너무 강하게 결합도를 갖고 있다는 생각을 했습니다.

저의 사례로 프로젝트에서 react와 preact를 번갈아 가면서 사용하고 있는데, zustand라는 상태 관리 라이브러리를 preact에서도 사용하고 싶었습니다. 하지만 Zustand는 공식적으로 Preact를 지원하지 않기 때문에 결국 사용하지 못하고 포기한 적이 있습니다.

백엔드 프레임워크들은 비슷한 종류의 외부 모듈과의 연결을 일반화하여 쉽게 의존성을 교체 할수 있도록 인터페이스를 제공하는 편이지만, 대부분의 프론트엔드 라이브러리들은 이런 지원이 약한 편입니다.

사실 처음 아이디어는 평범한 상태관리 라이브러리를 손쉽게 그리고 최대한 결합도가 낮게 UI라이브러리와 연결하는 커넥터를 만들고 싶었습니다만, 만드는 김에 상태관리 라이브러리도 함께 만들면 재미있겠다고 생각을 하여 “state-ref” 프로젝트를 시작하게 되었습니다.


## 6. 그 다음은 무엇일까?

사실 `state-ref`가 그렇게 복잡한 사용성을 갖은 라이브러리라고 생각하지 않고, 사실 개인 취미로 시작한 프로젝트라서 사용자가 많이 생길거라고 예상하지도 않습니다. 하지만 만약 운이 좋게 조금이라도 이 라이브러리에 관심을 갖고 사용하는 유저가 생긴다면 그 분들을 위해 상세한 문서화나 듀토리얼을 만들 의도가 있습니다.

그리고 `state-ref`는 현재 connect-vue, connect-preact, connect-react, connect-svelte, connect-solid를 지원하고 있는데요 그 밖에도 많은 UI라이브러리와의 connector를 구현해볼 예정입니다.


## 7. state-ref와 웹 개발 전반의 미래는 어떻게 보입니까? 특정 트렌드를 볼 수 있나요?

현재 React의 Next.js, Vue의 Nuxt, Svelte의 SvelteKit과 같은 프레임워크 및 Recoil, Vuex, Svelte/store와 같은 상태 관리 라이브러리들은 강한 결합을 통해 긴밀하게 서비스되고 있습니다. 하지만 개인적으로는 앞으로 이러한 라이브러리와 프레임워크, 상태 관리 솔루션들이 다양한 모듈들과의 결합도가 낮아져, 보다 유연하게 통합되고 쉽게 교체할 수 있는 시대가 도래하리라 기대합니다.

이러한 맥락에서 `state-ref`가 모범적인 사례로 자리 잡아 많은 이들에게 영감을 주기를 기대합니다.

## 8. 웹 개발에 입문하는 프로그래머에게 어떤 조언을 해주시겠어요?


저 역시 그랬지만, 많은 사람들이 코딩을 처음 접할 때는 어린아이의 순수한 호기심과 재미를 안고 시작합니다. 그러나 코딩을 직업으로 삼게 되면 그 즐거움이 사라지고 호기심 또한 줄어드는 경우가 많습니다.

초기에 가졌던 호기심을 잃지 말고 다양한 시도를 해보세요. 작은 아이디어라도 떠오르면 꼭 실현해보고 주변과 공유해보세요. 꼭 그게 프로그래밍과 관련되지 않더라도요.

여러분이 생각해낸 아이디어는 결코 사소하거나 개인적인 것이 아닐지도 몰라요. 세상에 조금이라도 기여하라는 신의 메시지일지도 모릅니다. 이렇게 생각하면 삶에 의미가 더해집니다. 저도 이 사실을 너무 늦게 최근에야 알아냈습니다.
저 같은 경우에는 이렇게 생각하므로서 코딩에 새로운 재미가 더해지고 실력도 크게 향상된 것 같습니다(사실 아직도 갈길이 멀었지만).

## 9. 다음에는 누구를 인터뷰해야 할까요?

[VanJS](https://vanjs.org/about) 를 만든 `Tao Xin`과의 인터뷰를 추천합니다. 그와 특별히 잘 아는 사이는 아니지만, 좋은 의도와 아이디어로 VanJS를 만들어가는 그의 열정이 항상 멋지다고 생각해 오고 있었습니다. 사람들에게 큰 영감을 줄 수 있는 좋은 개발자라고 생각합니다.

## 10. 마지막으로 하고 싶은 말씀이 있나요?

`stateRef`는 단순히 취미로 만든 프로젝트입니다. 하지만 제 열정을 많이 쏟았기 때문에 매우 자랑스럽게 생각합니다. 제 프로젝트에 관심을 가지고 인터뷰를 제안해 주신 Juho에게 다시 한 번 깊은 감사의 말을 전합니다.

